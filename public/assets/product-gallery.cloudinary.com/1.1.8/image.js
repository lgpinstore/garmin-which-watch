/*!
 * Cloudinary --> Product Gallery Widget
 * build: 1.1.8
 * ** /
 */
"use strict";(self.webpackChunk_cld_gallery_widget=self.webpackChunk_cld_gallery_widget||[]).push([[9],{9896:function(t,e,i){i.r(e),i.d(e,{default:function(){return I}});var o=i(4942),s=i(6400),r=i(8446),a=i.n(r),h=i(390),n=i(4492),l=i(8354),d=i(6281),m=i(9280),c=i(3462),p={getAdjustedDims:c.J1,checkSameRatio:c.f4,loadHighResImage:(t,e,i,o,s)=>new Promise(((r,a)=>{const n=((t,e,i,o)=>{const{mediaType:s,publicId:r,context:a}=t;switch(s){case h.MediaSymbolTypes.VIDEO:return a.cloudinary.getVideoThumbnailUrl(r,e,i,o);case h.MediaSymbolTypes.THREE:return a.cloudinary.getThreeThumbnailUrl(r,e,i,o);default:return a.cloudinary.getImageUrl(r,e,i,o)}})(t,i,o,s);e(t.publicId,n,i,o,s).then((t=>{r(t)}),(()=>{a()}))})),loadZoomImage:(t,e,i,o,s)=>new Promise(((r,a)=>{const n=t.context.config.selectZoomPropsLevel(),l=i*n,d=o*n,m=((t,e,i,o)=>{const{mediaType:s,publicId:r,context:a}=t;return s===h.MediaSymbolTypes.VIDEO?a.cloudinary.getVideoThumbnailUrl(r,e,i,o):a.cloudinary.getImageUrl(r,e,i,o,{pgwact:1})})(t,l,d,s);e(t.publicId,m,l,d,s).then((t=>{r(t)}),(()=>{a()}))}))},g=i(5088);const u=(0,i(4487).c)((()=>i.e(312).then(i.bind(i,9593))));class w extends s.wA{constructor(...t){super(...t),(0,o.Z)(this,"state",{error:!1,url:void 0,zoomUrl:void 0})}componentDidMount(){const{width:t,height:e,breakpoint:i,zoom:o,context:{cacher:s}}=this.props,r=p.getAdjustedDims(t,e,i);this.props.active&&this.initImage(s,r.width,r.height,!0,o)}componentDidUpdate(t){const{width:e,height:i,breakpoint:o,context:s,context:{config:r}}=this.props,n=p.getAdjustedDims(t.width,t.height,o),l=p.getAdjustedDims(e||0,i||0,o),d=p.checkSameRatio(n.width,n.height,l.width,l.height),m=a()(t.publicId,this.props.publicId),c=a()(t.transformation,this.props.transformation),g=this.props.active&&!1===t.active,u=this.props.zoom&&r.selectZoomPropsType(),w=this.props.zoom&&u!==h.ZoomType.POPUP;l.width>n.width&&d||g?this.initImage(s.cacher,l.width,l.height,!0,w):m&&d&&c?this.props.zoom&&!t.zoom&&this.initImage(s.cacher,l.width,l.height,!1,w):(this.resetImage(),this.initImage(s.cacher,l.width,l.height,!0,w,this.getTransformation(t.transformation)))}resetImage(){this.setState({url:void 0})}initImage(t,e,i,o,s,r){r=r||this.getTransformation(),this.setState({error:!1}),o&&p.loadHighResImage(this.props,t,e,i,r).then((t=>this.setState({url:t.url})),(()=>this.setState({error:!0}))),s&&p.loadZoomImage(this.props,t,e,i,r).then((t=>this.setState({zoomUrl:t.url})),(()=>{this.setState(this.state.url?{zoomUrl:this.state.url}:{error:!0})}))}getTransformation(t){if(t&&t!==this.props.transformation||!this.currTransformation){const e=this.props.transformation||t;this.currTransformation=e}return this.currTransformation}render(t){const{config:e}=t.context,i=e.selectZoomPropsType();return(0,s.h)(m.d,{"data-test":"image-wrap","data-ready":!!this.state.url,className:t.className},!this.state.error&&!this.state.url&&(t.width>150||t.height>150)&&(0,s.h)(n.Z,{publicId:t.publicId,width:t.width,height:t.height,transformation:this.getTransformation(),mediaType:t.mediaType}),this.state.url&&!this.state.error?(0,s.h)(m.d,{relative:!0,"data-test":"img-zoom-wrap"},(0,s.h)("img",{itemprop:"image",draggable:!1,src:this.state.url,onLoad:t.onLoad,className:m.q,alt:t.alt,width:t.width,height:t.height}),t.zoom&&(0,s.h)(u,{key:`zoom-${t.publicId}`,zoomIn:t.zoomState,setZoom:t.setZoom,width:t.width,height:t.height,url:this.state.zoomUrl||this.state.url,publicId:t.publicId,index:t.index,trigger:e.selectZoomPropsTrigger(),alt:t.alt,type:g.isMobile&&i!==h.ZoomType.POPUP?h.ZoomType.INLINE:i,viewerPosition:e.selectZoomPropsViewerPosition(),viewerContainer:g.isMobile?void 0:e.selectZoomPropsContainer(),level:e.selectZoomPropsLevel(),inPopup:t.inPopup})):null,this.state.error?(0,s.h)(l.Z,{width:t.width}):null)}}var I=(0,d.l)(w)}}]);
//# sourceMappingURL=image.js.map